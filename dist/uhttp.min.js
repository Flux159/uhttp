/*! uhttp v1.2.3 | (c) 2017 @flux159 | http://flux159.github.io/uhttp/ */
!function(t,e){"undefined"!=typeof module?module.exports=e():t.uhttp=e()}(this,function(){"use strict";function t(t,e){this.name=t,this.data={},e||(e={}),this.timeout=e.timeout||0}function e(t){return null!==t&&"object"==typeof t}function n(t){return null!==t&&"string"==typeof t}function r(t){return"[object File]"===d.call(t)}function o(t){return"[object Blob]"===d.call(t)}function a(t){return"[object FormData]"===d.call(t)}function s(t){var e=t;return document.documentMode&&(v.setAttribute("href",e),e=v.href),v.setAttribute("href",e),{href:v.href,protocol:v.protocol?v.protocol.replace(/:$/,""):"",host:v.host,search:v.search?v.search.replace(/^\?/,""):"",hash:v.hash?v.hash.replace(/^#/,""):"",hostname:v.hostname,port:v.port,pathname:"/"===v.pathname.charAt(0)?v.pathname:"/"+v.pathname}}function u(t){var e=n(t)?s(t):t;return e.protocol===g.protocol&&e.host===g.host}function i(t){if(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(e))return o.substring(e.length,o.length)}return""}return document.cookie}function c(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function f(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n])}function l(t){return new Promise(function(e,n){var r="uhttp_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),o=document.createElement("script");h[r]=function(t){o.parentNode.removeChild(o),h[r]=void 0,o=null,r=null,e(t)},o.onerror=function(t){o.parentNode.removeChild(o),h[r]=void 0,o=null,r=null,n(t)},o.src=t.replace("JSON_CALLBACK",r),document.body.appendChild(o)})}function p(t,n,s,l){s||(s={});var p=new Promise(function(d,v){var g={};if(c(g,{Accept:"application/json, text/plain, */*"}),"POST"!==t&&"PUT"!==t&&"PATCH"!==t||!e(l)||r(l)||o(l)||a(l)||c(g,{"Content-Type":C}),c(g,T.headers),e(s.headers)&&c(g,s.headers),u(n)){var y={},b=i(s.xsrfCookieName||T.xsrfCookieName||R.xsrfCookieName);b&&(y[s.xsrfHeaderName||T.xsrfHeaderName||R.xsrfHeaderName]=b,c(g,y))}var q={timeout:s.timeout||T.timeout,cache:s.cache||T.cache,withCredentials:s.withCredentials||T.withCredentials,progressHandler:s.progressHandler||T.progressHandler,transformRequest:s.transformRequest||T.transformRequest||R.transformRequest,transformResponse:s.transformResponse||T.transformResponse||R.transformResponse,transformRequestData:s.transformRequestData||T.transformRequestData||R.transformRequestData,transformResponseData:s.transformResponseData||T.transformResponseData||R.transformResponseData},w={headers:g,options:q,type:t,url:n};q.transformRequest(w);var D=w.options.cache;if("GET"===w.type&&D){var k;if(k="boolean"==typeof D?m.get("__default").get(n):"Cache"===D.constructor.name?D.get(n):D.cache.get(n))return setTimeout(function(){d(s.details?{res:k,status:304,request:null}:k)},0),p}var x=new(h.XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");w.options.progressHandler&&x.upload&&(x.upload.onprogress=w.options.progressHandler),x.open(w.type,w.url,!0),f(x,w.headers),w.options.withCredentials&&(x.withCredentials=!0),x.onreadystatechange=function(){if(4===x.readyState){w.options.transformResponse(x);var e=w.options.transformResponseData(x);x.status>=200&&x.status<300||304===x.status?("GET"===t&&D&&("boolean"==typeof D?m.get("__default").set(n,e):"Cache"===D.constructor.name?D.set(n,e):D.cache.set(n,e,D.options)),d(s.details?{res:e,status:x.status,request:x}:e)):v(s.details?{err:e,status:x.status,request:x}:e),w=null,x=null,e=null}},x.send(w.options.transformRequestData(l)),w.options.timeout>0&&setTimeout(function(){x&&x.abort()},w.options.timeout)});return p}var h=window;t.prototype.remove=function(t){delete this.data[t]},t.prototype.clear=function(){this.data={}},t.prototype.set=function(t,e,n){if(this.data[t]=e,n||(n={}),(n.timeout||this.timeout)>0){var r=this;setTimeout(function(){r.remove(t)},n.timeout||this.timeout)}},t.prototype.get=function(t){return this.data[t]};var m=function(){function e(){var e={__default:new t("__default")};return{get:function(n,r){if(e[n])return e[n];var o=new t(n,r);return e[n]=o,o}}}var n=null;return{getFactory:function(){return n||(n=e()),n}}}().getFactory(),d=Object.prototype.toString,v=document.createElement("a"),g=s(h.location.href),R={transformRequest:function(t){return t},transformResponse:function(t){return t},transformRequestData:function(t){return!e(t)||r(t)||o(t)||a(t)?t:JSON.stringify(t)},transformResponseData:function(t){var e,n=t.responseText;try{e=JSON.parse(n)}catch(t){e=n}return e},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},T={headers:{},timeout:0,withCredentials:!1},C="application/json;charset=utf-8",y={};return y.setGlobalOptions=function(t){(T=t).headers&&e(T.headers)||(T.headers={})},y.getGlobalOptions=function(){return T},y.CacheFactory=m,y.getCookie=i,y.setCookie=function(t,e,n){if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var o="expires="+r.toUTCString();document.cookie=t+"="+e+"; "+o+"; path=/"}else document.cookie=t+"="+e+"; path=/"},y.setCookieFromString=function(t){document.cookie=t},y.deleteCookie=function(t,e){document.cookie=e?t+"=; path="+e+"; expires=Thu, 01 Jan 1970 00:00:01 GMT;":t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},y.parallel=function(t,e){for(var n=0,r=[],o=null,a=t.length,s=0;s<a;s++){var u=t[s];r.push(null),function(t,s){u.then(function(s){r[t]=s,++n===a&&e(o,r)}).catch(function(s){r[t]=null,o?o.push(s):o=[s],++n===a&&e(o,r)})}(s)}},y.settle=function(t,e){for(var n=0,r=[],o=t.length,a=0;a<o;a++){var s=t[a];r.push(null),function(t,a){s.then(function(a){r[t]={state:"fulfilled",res:a,err:null},++n===o&&e(r)}).catch(function(a){r[t]={state:"rejected",res:null,err:a},++n===o&&e(r)})}(a)}},y.get=function(t,e){return p("GET",t,e)},y.head=function(t,e){return p("HEAD",t,e)},y.put=function(t,e,n){return n||(n=e,e=null),p("PUT",t,e,n)},y.patch=function(t,e,n){return n||(n=e,e=null),p("PATCH",t,e,n)},y.post=function(t,e,n){return n||(n=e,e=null),p("POST",t,e,n)},y.delete=function(t,e){return p("DELETE",t,e)},y.jsonp=function(t){return l(t)},y});