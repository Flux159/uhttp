/*! uhttp v2.0.1 | (c) 2018 @flux159 | http://flux159.github.io/uhttp/ */
!function(t,e){"undefined"!=typeof module?module.exports=e():t.uhttp=e()}(this,function(){"use strict";function t(t,e){this.name=t,this.data={},e||(e={}),this.timeout=e.timeout||0}function e(t){return null!==t&&"object"==typeof t}function n(t){return null!==t&&"string"==typeof t}function o(t){return"[object File]"===m.call(t)}function r(t){return"[object Blob]"===m.call(t)}function a(t){return"[object FormData]"===m.call(t)}function u(t){var e=t;return document.documentMode&&(v.setAttribute("href",e),e=v.href),v.setAttribute("href",e),{href:v.href,protocol:v.protocol?v.protocol.replace(/:$/,""):"",host:v.host,search:v.search?v.search.replace(/^\?/,""):"",hash:v.hash?v.hash.replace(/^#/,""):"",hostname:v.hostname,port:v.port,pathname:"/"===v.pathname.charAt(0)?v.pathname:"/"+v.pathname}}function i(t){var e=n(t)?u(t):t;return e.protocol===g.protocol&&e.host===g.host}function s(t){if(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""}return document.cookie}function c(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function l(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n])}function f(t){return new Promise(function(e,n){var o="uhttp_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),r=document.createElement("script");h[o]=function(t){r.parentNode.removeChild(r),h[o]=void 0,r=null,o=null,e(t)},r.onerror=function(t){r.parentNode.removeChild(r),h[o]=void 0,r=null,o=null,n(t)},r.src=t.replace("JSON_CALLBACK",o),document.body.appendChild(r)})}function p(t,n,u,f){u||(u={});var p=new Promise(function(m,v){var g={};if(c(g,{Accept:"application/json, text/plain, */*"}),"POST"!==t&&"PUT"!==t&&"PATCH"!==t||!e(f)||o(f)||r(f)||a(f)||c(g,{"Content-Type":C}),c(g,y.headers),e(u.headers)&&c(g,u.headers),i(n)){var b={},k=s(u.xsrfCookieName||y.xsrfCookieName||T.xsrfCookieName);k&&(b[u.xsrfHeaderName||y.xsrfHeaderName||T.xsrfHeaderName]=k,c(g,b))}var x=Object.assign({},T,y,u),N={headers:g,options:x,type:t,url:n};x.transformRequest(N);var O=N.options.cache;if("GET"===N.type&&O){var w;if(w="boolean"==typeof O?d.get("__default").get(n):"Cache"===O.constructor.name?O.get(n):O.cache.get(n))return setTimeout(function(){m(u.details?{res:w,status:304,request:null}:w)},0),p}var S=new(h.XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");N.options.progressHandler&&S.upload&&(S.upload.onprogress=N.options.progressHandler),S.open(N.type,N.url,!0),l(S,N.headers),N.options.withCredentials&&(S.withCredentials=!0),S.onreadystatechange=function(){if(4===S.readyState){N.options.transformResponse(S);var e=N.options.transformResponseData(S);S.status>=200&&S.status<300||304===S.status?("GET"===t&&O&&("boolean"==typeof O?d.get("__default").set(n,e):"Cache"===O.constructor.name?O.set(n,e):O.cache.set(n,e,O.options)),m(u.details?{res:e,status:S.status,request:S}:e)):v(u.details?{err:e,status:S.status,request:S}:e),N=null,S=null,e=null}},S.send(N.options.transformRequestData(f)),N.options.timeout>0&&setTimeout(function(){S&&S.abort()},N.options.timeout)});return p}var h=window;t.prototype.remove=function(t){delete this.data[t]},t.prototype.clear=function(){this.data={}},t.prototype.set=function(t,e,n){if(this.data[t]=e,n||(n={}),(n.timeout||this.timeout)>0){var o=this;setTimeout(function(){o.remove(t)},n.timeout||this.timeout)}},t.prototype.get=function(t){return this.data[t]};var d=function(){function e(){var e={__default:new t("__default")};return{get:function(n,o){if(e[n])return e[n];var r=new t(n,o);return e[n]=r,r}}}var n=null;return{getFactory:function(){return n||(n=e()),n}}}().getFactory(),m=Object.prototype.toString,v=document.createElement("a"),g=u(h.location.href),T={transformRequest:function(t){return t},transformResponse:function(t){return t},transformRequestData:function(t){return!e(t)||o(t)||r(t)||a(t)?t:JSON.stringify(t)},transformResponseData:function(t){var e,n=t.responseText;try{e=JSON.parse(n)}catch(t){e=n}return e},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},y={headers:{},timeout:0,withCredentials:!1},C="application/json;charset=utf-8",b={};return b.setGlobalOptions=function(t){(y=t).headers&&e(y.headers)||(y.headers={})},b.getGlobalOptions=function(){return y},b.CacheFactory=d,b.getCookie=s,b.setCookie=function(t,e,n){if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var r="expires="+o.toUTCString();document.cookie=t+"="+e+"; "+r+"; path=/"}else document.cookie=t+"="+e+"; path=/"},b.setCookieFromString=function(t){document.cookie=t},b.deleteCookie=function(t,e){document.cookie=e?t+"=; path="+e+"; expires=Thu, 01 Jan 1970 00:00:01 GMT;":t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},b.parallel=function(t,e){for(var n=0,o=[],r=null,a=t.length,u=0;u<a;u++){var i=t[u];o.push(null),function(t,u){i.then(function(u){o[t]=u,++n===a&&e(r,o)}).catch(function(u){o[t]=null,r?r.push(u):r=[u],++n===a&&e(r,o)})}(u)}},b.settle=function(t,e){for(var n=0,o=[],r=t.length,a=0;a<r;a++){var u=t[a];o.push(null),function(t,a){u.then(function(a){o[t]={state:"fulfilled",res:a,err:null},++n===r&&e(o)}).catch(function(a){o[t]={state:"rejected",res:null,err:a},++n===r&&e(o)})}(a)}},b.get=function(t,e){return p("GET",t,e)},b.head=function(t,e){return p("HEAD",t,e)},b.put=function(t,e,n){return n||(n=e,e=null),p("PUT",t,e,n)},b.patch=function(t,e,n){return n||(n=e,e=null),p("PATCH",t,e,n)},b.post=function(t,e,n){return n||(n=e,e=null),p("POST",t,e,n)},b.delete=function(t,e){return p("DELETE",t,e)},b.jsonp=function(t){return f(t)},b});