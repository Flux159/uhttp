{"name":"uhttp","tagline":"A micro client-side ajax library modeled after angularjs's http module that doesn't require any dependencies","body":"# uhttp\r\n\r\nA micro ajax library modeled after angularjs's $http module that doesn't require any dependencies (jquery or otherwise). As of version 1.1.0, uhttp runs in browsers as well as in nodejs.\r\n\r\nuhttp is about 6kb minified and about 2.3kb minified and compressed.\r\n\r\nuhttp supports setting headers globally for all requests and setting headers individually for each request. It also automatically parses json in responses with the appropriate content type. uhttp is based off of [atomic](https://github.com/toddmotto/atomic) and angularjs's [$http](https://github.com/angular/angular.js/blob/v1.3.x/src/ng/http.js). uhttp was written because atomic didn't support common features (setting headers & sending json POST requests) and [React](https://facebook.github.io/react/index.html) didn't come with a built in ajax library (recommending jQuery's ajax instead).\r\n\r\nNote that uhttp does not use true [promises](https://github.com/jakearchibald/es6-promise).\r\n\r\n#### Downloading & Setting up\r\n\r\nDownload the minified build [here](https://raw.githubusercontent.com/Flux159/uhttp/master/dist/uhttp.min.js), put into your public scripts directory, and add to your webpage by adding the following tag:\r\n\r\n```html\r\n<script type=\"application/javascript\" src=\"/scripts/uhttp.min.js\"></script>\r\n```\r\n\r\nAlternatively, you can install from bower as well:\r\n```shell\r\nbower install uhttp --save\r\n```\r\n\r\nTo install with nodejs, run the following:\r\n```shell\r\nnpm install uhttp --save\r\n```\r\n\r\nUse server side by requiring in your files:\r\n```javascript\r\nvar uhttp = require('uhttp');\r\n```\r\n\r\n#### uhttp.get(url, [,options])\r\nUse uhttp.get() to make a GET request. You can use \"then... catch\" callbacks to obtain the response.\r\n\r\n```javascript\r\nuhttp.get('/api/endpoint').then(function(res, status, xhr) {\r\n    //Successful response\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n\r\n```\r\n\r\nYou can specify options by passing an options object to any request (see the Options section for more information):\r\n\r\n```javascript\r\nvar options = {\r\n    headers: {\r\n        'custom': 'header'\r\n    },\r\n    withCredentials: true,\r\n    timeout: 3000 //3 seconds; '0' for no timeout\r\n};\r\n\r\nuhttp.get('/api/endpoint', options).then(function(res, status, xhr) {\r\n    //Success\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n\r\n```\r\n\r\n#### uhttp.post(url, [,options] [,data])\r\n\r\nUse uhttp.post() to make a POST request. By default, the content type for JSON and FormData (multipart/form-data NOT application/x-www-form-urlencoded) is automatically set for you. To change this, either set a global default for the \"Content-Type\" header, or pass it in as an option.\r\n\r\n```javascript\r\nuhttp.post('/api/endpoint/post', {some: 'data'}).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\nExample using FormData (Content-Type: multipart/form-data) in javascript:\r\n```javascript\r\nvar formElement = document.getElementById(\"myform\");\r\nvar formData = new FormData(formElement);\r\nformData.append(\"username\", \"cat\");\r\nuhttp.post('/api/endpoint/post/form/multipart', formData).then(function(data) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\n##### Posting x-www-form-urlencoded data\r\n\r\nHere is an example of posting x-www-form-urlencoded data. Note that if you want all requests sent with these options by default, use uhttp.setGlobalOptions (see documentation below).\r\n\r\n```javascript\r\nvar data = {\r\n    content: 'Sending json object as x-www-form-urlencoded'\r\n};\r\n\r\nvar options = {\r\n    headers: {'Content-Type': 'application/x-www-form-urlencoded'},\r\n    transformRequestData: function(data) {\r\n        var str = [];\r\n        for(var p in data) {\r\n            str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(data[p]));\r\n        }\r\n        return str.join(\"&\");\r\n}};\r\n\r\nuhttp.post('/api/endpoint/post/form/urlencoded', options, data).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\nExample setting a custom content type:\r\n```javascript\r\nvar myCustomData = '<custom>xml</custom>';\r\nuhttp.post('/api/endpoint/post', {'Content-Type': 'application/xml'}, myCustomData).then(function(res, status, xhr) {\r\n    //Success\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### uhttp.put()\r\n\r\nUse uhttp.put() to make a PUT request. The options are similar to POST requests.\r\n\r\n```javascript\r\nuhttp.put('/api/endpoint/put', {some: 'data'}).then(function(res, status, xhr) {\r\n    //Success\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### uhttp.patch()\r\n\r\nUse uhttp.patch() to make a PATCH request.\r\n\r\n```javascript\r\nuhttp.patch('/api/endpoint/patch', {some: 'data'}).then(function(res, status, xhr) {\r\n    //Success\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### uhttp.delete()\r\n\r\nUse uhttp.delete() to send a DELETE request.\r\n\r\n```javascript\r\nuhttp.delete('/api/endpoint/delete').then(function(res, status, xhr) {\r\n    //Success\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### uhttp.head()\r\n\r\nUse uhttp.head() to send a HEAD request.\r\n\r\n```javascript\r\nuhttp.head('/api/endpoint/head').then(function(res, status, xhr) {\r\n    //Success\r\n    console.log(xhr.getHeader('Custom-Header'));\r\n}).catch(function(err, status, xhr) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### uhttp.jsonp()\r\n\r\nUse uhttp.jsonp() to send a JSONP request. Note that you should define the callback as 'JSON_CALLBACK'. uhttp will generate a global function attached to the window object for the duration of the request and pass its data to the then/catch functions. Note that since [jsonp](http://en.wikipedia.org/wiki/JSONP) requests use a script element and not xhr, there is no status or xhr returned in the callback.\r\n\r\n```javascript\r\nuhttp.jsonp('/api/endpoint/jsonp?callback=JSON_CALLBACK').then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### Xsrf\r\nuhttp handles setting an XSRF header for you based on the options xsrfCookieName and xsrfHeaderName options. The default options are cookieName = 'XSRF-TOKEN' and headerName = 'X-XSRF-TOKEN'. Note that uhttp takes the value of the cookie (not the name) and sets the header given by xsrfHeaderName to that value. To change these, specify the options before sending your requests:\r\n\r\n```javascript\r\nvar globalOptions = {\r\n    xsrfCookieName: 'CUSTOM-COOKIE-NAME',\r\n    xsrfHeaderName: 'CUSTOM-HEADER-NAME'\r\n};\r\n\r\nuhttp.setGlobalOptions = globalOptions;\r\n\r\nuhttp.get('/xsrf/endpoint').then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n\r\n```\r\n\r\n#### Example: Sending a file\r\nA common use case for POSTing data is to send a file to your server (like an image or video file). uhttp makes that easy by allowing you to specify a progress callback with your POST request. Note that this example uses Xhr2, which is not supported by IE8. Check [caniuse](http://caniuse.com/#feat=xhr2) for more information on browser compatibility. For a full example, see the example in /test/testupload.html. Note that this example will only work in browsers (nodejs does not support FormData objects, however, it may be possible to use [this](https://github.com/felixge/node-form-data) library - this has not been tested w/ uhttp however).\r\n\r\n```javascript\r\n\r\nvar files = document.getElementById('upload-input-element').files;\r\n\r\nvar file = files[0];\r\n\r\nvar data = new FormData();\r\ndata.append('userfile', file);\r\n\r\nvar options = {\r\n    progressHandler: function(event) {\r\n        if(event.lengthComputable) {\r\n            var percentageLoaded = event.loaded / event.total;\r\n            document.findElementById('upload-progress-bar').setAttribute('style', 'width: ' + percentageLoaded + ';');\r\n        }\r\n    }\r\n};\r\n\r\nuhttp.post('/upload/endpoint', options, data).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n\r\n```\r\n\r\n#### Example: Authorization Tokens\r\nIf your requests require tokens, you can specify them as custom headers (also note that you can set these globally for all requests by calling uhttp.setGlobalOptions(globalOptions).\r\n\r\n```javascript\r\nvar MY_TOKEN = 'CUSTOM_AUTH_TOKEN';\r\nvar options = {\r\n    headers: {\r\n        'Authorization': 'Bearer ' + MY_TOKEN\r\n    }\r\n};\r\n\r\nuhttp.get('/protected/api/endpoint', options).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### Example: CORS (Cross Origin Requests)\r\n\r\nCORS is a way of sending requests to a different domain than the one you are currently browsing. CORS is enabled on a server by setting the appropriate headers on the server.\r\n\r\nServer pseudo code:\r\n```javascript\r\nresponse.header('Access-Control-Allow-Origin', 'http://example.com');\r\nresponse.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE');\r\nresponse.header('Access-Control-Allow-Headers', 'Content-Type');\r\nresponse.header('Access-Control-Allow-Credentials', true);\r\n```\r\n\r\nUsing uhttp, if the server has required credentials (by the 'Access-Control-Allow-Credentials' header), you would need to set the withCredentials option to correctly send your request. You would also need to set any authorization headers the server requires (tokens, etc.).\r\n\r\n```javascript\r\nvar MY_TOKEN = 'CUSTOM_AUTH_TOKEN';\r\nvar options = {\r\n    headers: {\r\n        'Authorization': 'Bearer ' + MY_TOKEN\r\n    },\r\n    withCredentials: true\r\n};\r\n\r\nuhttp.get('http://subdomain.example.com/protected/api/endpoint', options).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n\r\n```\r\n\r\n#### Global Options\r\n\r\nYou can set global options by using the uhttp.setGlobalOptions(options) method. Note that \"global\" means on each page. If you are not using a single page web application architecture, you will need to set these options in a common script across all your pages. In a single page application architecture, this works as expected after setting once.\r\n\r\n```javascript\r\nuhttp.setGlobalOptions({\r\n    headers: {\r\n        'Custom': 'Global-Header'\r\n    },\r\n    timeout: 2000, //Set timeout to 2 seconds\r\n    withCredentials: true, //Set withCredentials on xhr requests,\r\n    transformRequest: function(xhr) {}, //Transform xhr before sending (also before transformRequestData)\r\n    transformResponse: function(xhr) {}, //Transform xhr after response (but before transformResponseData)\r\n    transformRequestData: function(data) {return data;}, //Transform requests before sending\r\n    transformResponseData: function(data) {return data;}, //Transform returned responses\r\n    caching: true || [Cache object] || {cache: [Cache object], options: {timeout: 120000}}, //Set whether to globally cache all requests (not recommended - use individual request options instead)\r\n    xsrfCookieName: String, //The name of the cookie where you store your xsrfToken\r\n    xsrfHeaderName: String //The name of the header to set the xsrfToken\r\n});\r\n```\r\n\r\nYou can also retrieve the global default options by using the uhttp.getGlobalOptions() method\r\n\r\n```javascript\r\nvar globalAjaxOptions = uhttp.getGlobalOptions();\r\nconsole.log(globalAjaxOptions);\r\n```\r\n\r\n#### Options\r\n\r\nThe options object is the same as the globalOptions object above except it can be passed with each individual request.\r\n\r\n###### Custom Headers\r\n\r\n```javascript\r\nvar options = {\r\n    headers: {\r\n        'Custom': 'Header'\r\n    }\r\n};\r\n\r\nuhttp.get('/api/endpoint', options).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\n###### Timeouts\r\n\r\n```javascript\r\nvar options = {\r\n    timeout: 2000 //Timeout of 2 seconds\r\n};\r\n\r\nuhttp.get('/api/endpoint', options).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\n#### Transforming Requests, Responses, and Data\r\n\r\nuhttp lets you transform requests and responses before they're sent / after their returned (globally or per request). This is useful if you need to modify how uhttp processes its requests by default.\r\n\r\n###### Transform Request (transformRequest) & Transform Response (transformResponse)\r\n\r\nTo modify the xhr object that uhttp uses before sending, set the transformRequest option.\r\n\r\n```javascript\r\nvar options = {\r\n    transformRequest: function(config) {\r\n        //Changes the source of the request\r\n        config.src = 'http://localhost:43760/api/get/again';\r\n\r\n        return config;\r\n    },\r\n    transformResponse: function(xhr) {\r\n        //Changes the response\r\n        xhr.responseText = '{\"data\": \"Man in the middle!\"}';\r\n    }\r\n};\r\n\r\nwindow.uhttp.get('http://localhost:43760/api/get', options).then(function(res) {\r\n    console.log(res.data); //prints \"Man in the middle!\"\r\n}).catch(function(err) {\r\n    //Do nothing\r\n}).finally(function() {\r\n    done();\r\n});\r\n```\r\n\r\n###### Transform Request Data (transformRequestData)\r\n\r\nTo modify the data that uhttp sends with the request, set the transformRequestData option. This is necessary if you're sending x-www-form-urlencoded data.\r\n\r\n```javascript\r\nvar data = {\r\n    content: 'Sending json object as x-www-form-urlencoded'\r\n};\r\n\r\nvar options = {\r\n    headers: {'Content-Type': 'application/x-www-form-urlencoded'},\r\n    transformRequestData: function(data) {\r\n        var str = [];\r\n        for(var p in data) {\r\n            str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(data[p]));\r\n        }\r\n        return str.join(\"&\");\r\n}};\r\n\r\nuhttp.post('/api/endpoint/post/form/urlencoded', options, data).then(function(res) {\r\n    //Success\r\n}).catch(function(err) {\r\n    //Error\r\n});\r\n```\r\n\r\n###### Transform Response Data (transformResponseData)\r\n\r\nTo modify the data that uhttp gets after getting a response, set the transformResponseData option.\r\n\r\n```javascript\r\n//This is the default transformResponseData that uhttp uses to parse JSON responses\r\nvar options = {\r\n    transformResponseData: function(req) {\r\n        var result;\r\n        var d = req.responseText;\r\n        try {\r\n            result = JSON.parse(d);\r\n        } catch(e) {\r\n            result = d;\r\n        }\r\n        return result;\r\n    }\r\n}\r\n\r\nwindow.uhttp.get('http://localhost:43760/api/get', options).then(function(res) {\r\n    console.log(res.data);\r\n}).catch(function(err) {\r\n    //Do nothing\r\n}).finally(function() {\r\n    done();\r\n});\r\n\r\n```\r\n\r\n###### Caching\r\n\r\nuhttp provides a basic caching mechanism where you can cache your GET responses (no xhr request is sent). By default, setting the cache option to true enables this and uses uhttp's default cache. If you need a custom cache object, you can use uhttp's CacheFactory to create a custom cache object that you can manually clear and set timeouts for. Note: Caching only works for GET requests.\r\n\r\n```javascript\r\nuhttp.get('http://localhost:43760/api/get', {cache: true}).then(function(res, status, xhr) {\r\n    //Sends xhr request\r\n   uhttp.get('http://localhost:43760/api/get', {cache: true}).then(function(res, status, xhr) {\r\n        //From javascript cache, no xhr request sent\r\n   }).catch(function(err) {\r\n        //Do nothing\r\n   });\r\n}).catch(function(err) {\r\n    //Do nothing\r\n});\r\n```\r\n\r\nCustom cache objects:\r\n\r\n```javascript\r\nvar cacheFactory = uhttp.CacheFactory;\r\nvar blogCache = cacheFactory.get('blogCache');\r\n\r\nblogCache.put('firstpost','My blog');\r\nblogCache.put('secondpost', 'stuff');\r\nblogCache.delete('firstpost');\r\nblogCache.get('secondpost');\r\nblogCache.clear();\r\n\r\n//You can pass this cache to uhttp's cache option as well!\r\nuhttp.get('http://localhost:43760/api/get', {cache: blogCache}).then(function(res, status, xhr) {\r\n    //Data is cached in blogCache w/ url as key (you now have control of when to delete from the cache)\r\n});\r\n\r\n```\r\n\r\n###### Cookies Helpers\r\n\r\nuhttp exposes its cookie helper functions as uhttp.getCookie() and uhttp.setCookie(). These can be helpful if you need to check or change cookie values in your app.\r\n\r\n```javascript\r\nuhttp.setCookie('mycookie', 'yum'); //Sets mycookie to 'yum'\r\nuhttp.setCookie('othercookie', 'yay!', 365); //Set cookie for 365 days\r\nconsole.log(uhttp.getCookie('mycookie')); //'yum'\r\nconsole.log(uhttp.getCookie('othercookie')); //'yay!'\r\n```\r\n\r\n#### Development, Testing, & Building\r\n\r\nuhttp is developed using a nodejs environment. Make sure that you have nodejs and npm installed, clone this source repository and run the following in the uhttp directory:\r\n\r\n```\r\nnpm install && grunt build\r\n```\r\n\r\nThat will install all dependencies for development, run uhttp's tests, and build a minified version of uhttp in the dist directory.\r\n\r\nIf you have bug fixes that you want merged into uhttp, submit a pull request on the github repository.\r\n\r\nLICENSE\r\n-----\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2015 Suyog Sonwalkar\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all\r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\nSOFTWARE.\r\n","google":"UA-47539617-6","note":"Don't delete this file! It's used internally to help with page regeneration."}